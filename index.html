<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
<div class="cf-turnstile" data-sitekey="0x4AAAAAAB7cY2EjPNVQi8Ls"></div>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grape ‚Ä¢ Quantum Audio Playground</title>
  <style>
    :root {
      --bg: #0f1020;
      --panel: #17182b;
      --ink: #e7e7ee;
      --muted: #a9a9c7;
      --accent: #8a2be2; /* grape-ish */
      --accent-2: #c084fc;
      --ok: #10b981;
      --warn: #f59e0b;
      --err: #ef4444;
      --radius: 16px;
      --shadow: 0 10px 25px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.03);
    }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Segoe UI Variable", "SF Pro Text", Arial, "Noto Sans", sans-serif;
      color: var(--ink);
      background: radial-gradient(1200px 600px at 20% -10%, rgba(138,43,226,.25), transparent),
                  radial-gradient(1400px 800px at 120% 110%, rgba(192,132,252,.18), transparent),
                  var(--bg);
    }
    .wrap { max-width: 1000px; margin: 0 auto; padding: 32px 20px 80px; }
    header {
      display: flex; align-items: center; justify-content: space-between; gap: 16px; margin-bottom: 24px;
    }
    .brand { display: flex; align-items: center; gap: 14px; font-weight: 700; letter-spacing: .4px; }
    .logo {
      width: 40px; height: 40px; border-radius: 12px; display: grid; place-items: center; font-size: 22px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: var(--shadow);
    }
    .title { font-size: clamp(20px, 2.2vw, 28px); }
    .subtitle { color: var(--muted); font-weight: 500; }

    .grid { display: grid; grid-template-columns: 1.1fr .9fr; gap: 20px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }

    .card { background: rgba(23,24,43,.8); border: 1px solid rgba(255,255,255,.06); border-radius: var(--radius); box-shadow: var(--shadow); }
    .card h2 { margin: 0; padding: 20px 20px 0; font-size: 18px; letter-spacing: .3px; }
    .card p { color: var(--muted); margin: 8px 20px 0; }
    .card .body { padding: 16px 20px 20px; }

    .toolbar { display: flex; gap: 8px; flex-wrap: wrap; padding: 12px; border-bottom: 1px solid rgba(255,255,255,.06); background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
      border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);
    }
    button, .btn {
      appearance: none; border: 0; padding: 10px 14px; border-radius: 12px; cursor: pointer; font-weight: 600; color: white;
      background: linear-gradient(135deg, var(--accent), var(--accent-2)); box-shadow: var(--shadow);
      transition: transform .06s ease, filter .2s ease; text-decoration: none; display: inline-flex; align-items: center; gap: 8px;
    }
    button:hover, .btn:hover { filter: brightness(1.08); }
    button:active, .btn:active { transform: translateY(1px); }

    .ghost { background: rgba(255,255,255,.06); }

    pre {
      margin: 0; overflow: auto; max-height: 480px; padding: 18px 20px; line-height: 1.5; font-size: 13.5px; border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius);
      background: #0b0c18; color: #e8e8f3; border: 1px solid rgba(255,255,255,.06);
    }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

    .status { display: flex; gap: 10px; align-items: center; padding: 14px 16px; border-radius: 12px; background: rgba(16,185,129,.1); border: 1px solid rgba(16,185,129,.35); color: #d1fae5; font-weight: 600; }
    .status span.dot { width: 10px; height: 10px; border-radius: 999px; background: var(--ok); box-shadow: 0 0 0 3px rgba(16,185,129,.25); display: inline-block; }

    details { margin: 8px 0; }
    summary { cursor: pointer; color: var(--muted); }
    ol.instructions { margin: 0 0 0 20px; }
    ol.instructions li { margin: 8px 0; }
    .small { font-size: 12px; color: var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">üçá</div>
        <div>
          <div class="title">Grape</div>
          <div class="subtitle">Quantum‚Äëaudio demo powered by Audio2Vec + QPAM</div>
        </div>
      </div>
      <a class="btn" id="downloadHtml" download="grape.html" href="#">Download page</a>
    </header>

    <div class="grid">
      <!-- Left: code viewer -->
      <section class="card">
        <div class="toolbar">
          <button id="copyCode" title="Copy Python to clipboard">Copy code</button>
          <button id="downloadCode" class="ghost" title="Download driver.py">Download driver.py</button>
        </div>
        <pre><code id="pycode">from audio2vec import Audio2Vec
import quantumaudio
import numpy
import anyio

# Create a memory object stream
send_stream, receive_stream = anyio.create_memory_object_stream(10)

# Example usage inside async context
async def use_streams():
    async with send_stream, receive_stream:
        await send_stream.send("hello")
        item = await receive_stream.receive()
        print("Received:", item)

audsend = send_stream
processor = Audio2Vec(audsend)
# We need a asarray feature of dimensions
dimensions = numpy.asarray(30332)
feature = Audio2Vec(nFeatures=dimensions)
# Load the QPam scheme
qpam = quantumaudio.load_scheme("qpam") # or directly access from quantumaudio.schemes.QPAM()
# Define an Input
original_data = quantumaudio.tools.test_signal() # for a random array of samples (range: -1.0 to 1.0)

# Encoding
encoded_circuit = qpam.encode(original_data)

# Decoding
decoded_data  = qpam.decode(encoded_circuit,shots=4000)
</code></pre>
      </section>

      <!-- Right: info & quick start -->
      <section class="card">
        <h2>Quick start</h2>
        <div class="body">
          <div class="status"><span class="dot"></span> Frontend ready ‚Äî connect your Python runtime to run.</div>
          <p>
            This page ships with a copy of <code>driver.py</code> and a clean UI. Use it as your
            landing screen for <strong>Grape</strong>. The code leverages <code>Audio2Vec</code> and
            <code>quantumaudio</code>'s QPAM scheme to encode/decode a test audio signal.
          </p>

          <details>
            <summary>Backend setup (example)</summary>
            <ol class="instructions">
              <li>Create a virtual environment and install your deps (e.g. <code>anyio</code>, <code>numpy</code>, and your audio libs).</li>
              <li>Run <code>python driver.py</code> to execute the quantum‚Äëaudio encode/decode demo.</li>
              <li>Wire this UI to your backend via a small HTTP or WebSocket bridge if you want live interaction.</li>
            </ol>
          </details>

          <details>
            <summary>What the code does</summary>
            <p class="small">
              It creates an in‚Äëmemory stream with <code>anyio</code>, prepares an <code>Audio2Vec</code>
              processor, loads the QPAM scheme from <code>quantumaudio</code>, generates a test signal,
              then encodes and decodes it with configurable <code>shots</code>.
            </p>
          </details>
        </div>
      </section>
    </div>

  <script>
    // Download the HTML itself
    (function() {
      const a = document.getElementById('downloadHtml');
      const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
      a.href = URL.createObjectURL(blob);
    })();

    // Copy and download buttons for the embedded Python code
    const codeEl = document.getElementById('pycode');
    const copyBtn = document.getElementById('copyCode');
    const dlBtn = document.getElementById('downloadCode');

    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(codeEl.textContent);
        copyBtn.textContent = 'Copied!';
        setTimeout(() => (copyBtn.textContent = 'Copy code'), 1200);
      } catch (e) {
        alert('Copy failed.');
      }
    });

    dlBtn.addEventListener('click', () => {
      const blob = new Blob([codeEl.textContent], { type: 'text/x-python' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'https://github.com/eotter-beep/grape/archive/refs/heads/main.zip';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
